# Plate bias

The _plate_bias_ QC module consists of a single [script](#main-script). It
uses _Plink_ find possible plate bias.

Use the following command to access the multiple scripts of the
_plate_bias_ QC module.

```shell-session
$ pyGenClean plate-bias --help
usage: pyGenClean plate-bias [-h] [-v] {run} ...

Check for plate bias.

options:
  -h, --help     show this help message and exit
  -v, --version  show program's version number and exit

subcommands:
  Below is a list of tools in the plate-bias module. Note that 'run'
  executes the main plate-bias pipeline.

  {run}
    run          Check for plate bias.
```

## Main script

The main script (accessed using the `run` subcommand) uses _Plink_
to find possible plate bias.

```shell-session
$ pyGenClean plate-bias run --help
usage: pyGenClean plate-bias run [-h] --bfile FILE --plates FILE
                                 [--p-filter FLOAT] [--nb-tasks N]
                                 [--plink-1.07] [--out FILE]

Check for plate bias.

options:
  -h, --help        show this help message and exit

Input files:
  --bfile FILE      The input file prefix (will find the plink binary files by
                    appending the prefix to the .bim, .bed and .fam files,
                    respectively).
  --plates FILE     The file containing the plate organization of each
                    samples. Must contains three column (with no header):
                    famID, indID and plateName.

Options:
  --p-filter FLOAT  The significance threshold used for the plate effect.
                    [1.0e-07]
  --nb-tasks N      The number of tasks for this analysis. [1]
  --plink-1.07      Use original Plink (version 1.07)

Output files:
  --out FILE        The prefix of the output files. [plate_bias]
```

### Input Files

This module uses _Plink_'s binary file format (`bed`, `bim` and `fam` files) for
the source data set (the data of interest). It also requires the plate
organization for each samples.

### Procedure

Here are the steps performed by the module:

1. Runs a plate bias analysis using _Plink_.
2. Extracts the list of significant markers after plate bias analysis.
3. Computes the frequency of all significant markers after plate bias
   analysis.

### Output files

Here is a comprehensive list of all the possible output files for each of the
steps described above.

!!! note
    The output prefix shown is the one by default (_i.e._ `plate_bias`).

`plate_bias.*.assoc.fisher`
: List of markers that were significant after the plate bias analysis. There is
  one file for each plate. If there are no significant markers for a given
  plate, the file will contain only the header.

`plate_bias.significant_markers.txt`
: The list of significant markers taken from the `*.assoc.fisher` files.

`plate_bias.significant_markers.summary.tsv`
: Summary informations for each of the significant markers. The information
  contains genomic location, minor allele frequency, p-value, odds ratio and
  associtated plate.

`plate_bias.significant_markers.frq`
: Frequency file for each of the significant markers (as generated by _Plink_).
